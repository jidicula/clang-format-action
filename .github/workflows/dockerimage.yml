name: Docker Image CI

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:

  build:

    runs-on: ubuntu-20.04

    steps:
    - uses: actions/checkout@v2.3.4
    - name: Build the Docker image
      run: docker build . --file Dockerfile --tag clang-format-action-test --no-cache
    - name: test the docker image
      run: docker run -e CLANG_FORMAT_VERSION=11 -e GITHUB_WORKSPACE=/test -it -v $(pwd)/test:/test --privileged debian:unstable-slim
